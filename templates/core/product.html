{% extends "partials/base.html" %} {% load static %} {% block main %}

<main>
  <div class="mb-md-1 pb-md-3"></div>
  <section class="product-single container product-single__type-9">
    <div class="row">
      <div class="col-lg-7">
        <div class="product-single__media" data-media-type="vertical-thumbnail">
          <div class="product-single__image">
            <div class="swiper-container">
              <div class="swiper-wrapper">
                <style>
                  .product-image {
                    max-width: 97%; /* Adjust this value to your preference */
                    max-height: 83%; /* Adjust this value to your preference */
                  }
                  
                </style>
                <div class="swiper-slide product-single__image-item">
                  <img
                    loading="lazy"
                    class="h-auto product-image"
                    src="{{products.image.url}}"
                    width="674"
                    height="674"
                    alt=""
                  />
                  <a
                    data-fancybox="gallery"
                    href="{{products.image.url}}"
                    data-bs-toggle="tooltip"
                    data-bs-placement="left"
                    title="Zoom"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <use href="#icon_zoom" />
                    </svg>
                  </a>
                </div>
                {% for image in product_images %}
                <div class="swiper-slide product-single__image-item">
                  <img
                    loading="lazy"
                    class="h-auto product-image"
                    src="{{ image.images.url }}"
                    width="674"
                    height="674"
                    alt=""
                  />
                  <a
                    data-fancybox="gallery"
                    href="{{ image.images.url }}"
                    data-bs-toggle="tooltip"
                    data-bs-placement="left"
                    title="Zoom"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <use href="#icon_zoom" />
                    </svg>
                  </a>
                </div>
                {% endfor %}

              </div>
              <div class="swiper-button-prev">
                <svg
                  width="7"
                  height="11"
                  viewBox="0 0 7 11"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <use href="#icon_prev_sm" />
                </svg>
              </div>
              <div class="swiper-button-next">
                <svg
                  width="7"
                  height="11"
                  viewBox="0 0 7 11"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <use href="#icon_next_sm" />
                </svg>
              </div>
            </div>
          </div>
          <div class="product-single__thumbnail">
            <div class="swiper-container">
              <div class="swiper-wrapper">

                <div class="swiper-slide product-single__image-item">

                  <img
                    loading="lazy"
                    class="h-auto"
                    src="{{products.image.url}}"
                    width="104"
                    height="104"
                    alt=""
                  />
                </div>
                {% for image in product_images %}
                <div class="swiper-slide product-single__image-item">

                  <img
                    loading="lazy"
                    class="h-auto"
                    src="{{ image.images.url }}"
                    width="104"
                    height="104"
                    alt=""
                  />
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-5">
        <div class="d-flex justify-content-between mb-4 pb-md-2">
          <div class="breadcrumb mb-0 d-none d-md-block flex-grow-1">
            <a
              href="/"
              class="menu-link menu-link_us-s text-uppercase fw-medium"
              >Home</a
            >
            <span class="breadcrumb-separator menu-link fw-medium ps-1 pe-1"
              >/</span
            >
            <a
              href="#"
              class="menu-link menu-link_us-s text-uppercase fw-medium"
              >{{products.title}}</a
            >
          </div>
          <!-- /.breadcrumb -->

          <!-- /.shop-acs -->
        </div>
        <h1 class="product-single__name">{{products.title}}</h1>
        <div class="product-single__rating">
          <div class="reviews-group d-flex">
            <svg
              class="review-star"
              viewBox="0 0 9 9"
              xmlns="http://www.w3.org/2000/svg"
            >
              <use href="#icon_star" />
            </svg>
            <svg
              class="review-star"
              viewBox="0 0 9 9"
              xmlns="http://www.w3.org/2000/svg"
            >
              <use href="#icon_star" />
            </svg>
            <svg
              class="review-star"
              viewBox="0 0 9 9"
              xmlns="http://www.w3.org/2000/svg"
            >
              <use href="#icon_star" />
            </svg>
            <svg
              class="review-star"
              viewBox="0 0 9 9"
              xmlns="http://www.w3.org/2000/svg"
            >
              <use href="#icon_star" />
            </svg>
            <svg
              class="review-star"
              viewBox="0 0 9 9"
              xmlns="http://www.w3.org/2000/svg"
            >
              <use href="#icon_star" />
            </svg>
          </div>
          <span class="reviews-note text-lowercase text-secondary ms-1"
            >0 reviews
          </span>
        </div>
        <div class="product-single__price">
          <span class="current-price">₹ <span id="clicked-price" class="product-price">{{ default_price }}</span></span>
        </div>
        <p class="gst_rate">(Includes <span id="gst_rate">{{ gst_rate }}</span> GST)</p>

        <div class="product-single__meta-info">
          <div class="meta-item">
            <label>SKU:</label>
            <span>{{products.sku}}</span>
          </div>
          <div class="meta-item">
            <label>HSN Code:</label>
            <span>{{products.hsn_code}}</span>
          </div>
          <div class="meta-item">
            <label>Application:</label>
            <span>{{products.application}}</span>
          </div>
          <div class="meta-item">
            <label>Packing size:</label>
            <span>{{ default_packaging_size }}</span>
          </div>
          <div class="meta-item">
            <label>Material:</label>
            <span>{{products.material}}</span>
          </div>
          <div class="meta-item">
            <label>Specifications:</label>
            <span>{{products.specifications}}</span>
          </div>
        </div>
        <form name="addtocart-form" method="post">

          <style>
            .product-section .swatch-list .selected-swatch {
              background-color: yellow;
            }
          </style>
          <div class="product-section">
            {% for variant in product_variants %}
            <div class="product-single__swatches">
              <div class="product-swatch text-swatches">
                <label>{{ variant.title }}</label>
                <div class="swatch-list">
                  {% for variant_type in product_variant_types %}
                  {% if variant_type.product_variant == variant %}
                  <input type="radio" name="variant_size" id="swatch-{{ variant_type.id }}" {% if forloop.first %}checked{% endif %} data-price="{{ variant_type.varient_price }}" data-gst="{{ variant_type.gst_rate }}" data-variant-type-id="{{ variant_type.id }}" />
                  <label class="swatch js-swatch {% if forloop.first %}selected-swatch{% endif %}" for="swatch-{{ variant_type.id }}" aria-label="{{ variant_type.variant_title }}" title="{{ variant_type.variant_title }}">{{ variant_type.variant_title }}</label>
                  {% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
            {% endfor %}
          
            {% for variation in product_variations %}
            <div class="product-single__swatches">
              <div class="product-swatch text-swatches">
                <label>{{ variation.variation_title }}</label>
                <div class="swatch-list">
                  {% for variant_type in product_variation_types %}
                  {% if variant_type.product_variation == variation %}
                  <input type="radio" name="variation_size" id="swatch-{{ variant_type.id }}" {% if forloop.first %}checked{% endif %} data-variation-type-id="{{ variant_type.id }}" />
                  <label class="swatch js-swatch {% if forloop.first %}selected-swatch{% endif %}" for="swatch-{{ variant_type.id }}" aria-label="{{ variant_type.variation_title }}" title="{{ variant_type.variation_title }}">{{ variant_type.variation_title }}</label>
                  {% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
            {% endfor %}
          </div>

      {% comment %} {% for variation_type, prices in variation_prices %}
      <h3>{{ variation_type.variation_title }}</h3>
      <ul>
          {% for price in prices %}
              <li>{{ price.product_variant_type.variant_title }}: {{ price.varient_type_price }}</li>
          {% endfor %}
      </ul>
  {% endfor %} {% endcomment %}
        
          <div class="product-single__addtocart">
            <div class="qty-control position-relative">
              <input
                type="number"
                name="quantity"
                value="1"
                id="product-quantity-{{products.pid}}"
                min="1"
                class="qty-control__number text-center product-quantity-{{products.pid}}"
              />
              <div class="qty-control__reduce">-</div>
              <div class="qty-control__increase">+</div>
            </div>
            <!-- .qty-control -->
            <input type="hidden" value="{{products.pid}}" class="product-id">
            <input type="hidden" value="{{products.pid}}" class="product-id-{{products.pid}}">
            <input type="hidden" value="{{products.title}}" class="product-title-{{products.pid}}">
            <input type="hidden" value="{{default_price}}" class="product-price-{{products.pid}}">
            <input type="hidden" value="{{price_wo_gst}}" class="product-price-wo-gst-{{products.pid}}">
            <input type="hidden" value="{{gst_rate}}" class="gst_rate-{{products.pid}}">
            <input type="hidden" value="{{products.sku}}" class="product-sku-{{products.pid}}">
            <input type="hidden" value="{{products.image.url}}" class="product-image-{{products.pid}}">
            <button
              type="submit"
              class="btn btn-primary btn-addtocart js-open-aside add-to-cart-btn"
              id="add-to-cart-btn"
              data-index="{{products.pid}}"
              data-aside="cartDrawer"
            >
              Add to Cart
            </button>
          </div>
        </form>

      </div>
    </div>
    <div class="product-single__details-list">
      <h2 class="product-single__details-list__title">Description</h2>
      <div class="product-single__details-list__content">
        <div class="product-single__description">
          <div class="row">
            <div class="col-lg-6">
              <h3 class="block-title">Why choose product?</h3>
              <ul class="list text-list">
                <li>Creat by cotton fibric with soft and smooth</li>
                <li>Simple, Configurable (e.g. size, color, etc.), bundled</li>
                <li>Downloadable/Digital Products, Virtual Products</li>
              </ul>
            </div>
            <div class="col-lg-6">
              <h3 class="block-title">Sample Number List</h3>
              <ol class="list text-list">
                <li>Create Store-specific attrittbutes on the fly</li>
                <li>Simple, Configurable (e.g. size, color, etc.), bundled</li>
                <li>Downloadable/Digital Products, Virtual Products</li>
              </ol>
            </div>
          </div>
          <h3 class="block-title mb-0">Lining</h3>
          <p class="content">100% Polyester, Main: 100% Polyester.</p>
        </div>
      </div>
      {% comment %} <h2 class="product-single__details-list__title">Reviews (3)</h2>
      <div class="product-single__details-list__content">
        <h3 class="product-single__reviews-title">Reviews</h3>
        <div class="product-single__reviews-list">
          <div class="product-single__reviews-item">
            <div class="customer-avatar">
              <img
                loading="lazy"
                src="{% static './images/avatar.jpg' %}"
                alt=""
              />
            </div>
            <div class="customer-review">
              <div class="customer-name">
                <h6>Janice Miller</h6>
                <div class="reviews-group d-flex">
                  <svg
                    class="review-star"
                    viewBox="0 0 9 9"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <use href="#icon_star" />
                  </svg>
                  <svg
                    class="review-star"
                    viewBox="0 0 9 9"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <use href="#icon_star" />
                  </svg>
                  <svg
                    class="review-star"
                    viewBox="0 0 9 9"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <use href="#icon_star" />
                  </svg>
                  <svg
                    class="review-star"
                    viewBox="0 0 9 9"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <use href="#icon_star" />
                  </svg>
                  <svg
                    class="review-star"
                    viewBox="0 0 9 9"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <use href="#icon_star" />
                  </svg>
                </div>
              </div>
              <div class="review-date">April 06, 2023</div>
              <div class="review-text">
                <p>
                  Nam libero tempore, cum soluta nobis est eligendi optio cumque
                  nihil impedit quo minus id quod maxime placeat facere
                  possimus, omnis voluptas assumenda est…
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="product-single__review-form">
          <form name="customer-review-form">
            <h5>Be the first to review “Message Cotton T-Shirt”</h5>
            <p>
              Your email address will not be published. Required fields are
              marked *
            </p>
            <div class="select-star-rating">
              <label>Your rating *</label>
              <span class="star-rating">
                <svg
                  class="star-rating__star-icon"
                  width="12"
                  height="12"
                  fill="#ccc"
                  viewBox="0 0 12 12"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1429 5.04687C11.1429 4.84598 10.9286 4.76562 10.7679 4.73884L7.40625 4.25L5.89955 1.20312C5.83929 1.07589 5.72545 0.928571 5.57143 0.928571C5.41741 0.928571 5.30357 1.07589 5.2433 1.20312L3.73661 4.25L0.375 4.73884C0.207589 4.76562 0 4.84598 0 5.04687C0 5.16741 0.0870536 5.28125 0.167411 5.3683L2.60491 7.73884L2.02902 11.0871C2.02232 11.1339 2.01563 11.1741 2.01563 11.221C2.01563 11.3951 2.10268 11.5558 2.29688 11.5558C2.39063 11.5558 2.47768 11.5223 2.56473 11.4754L5.57143 9.89509L8.57813 11.4754C8.65848 11.5223 8.75223 11.5558 8.84598 11.5558C9.04018 11.5558 9.12054 11.3951 9.12054 11.221C9.12054 11.1741 9.12054 11.1339 9.11384 11.0871L8.53795 7.73884L10.9688 5.3683C11.0558 5.28125 11.1429 5.16741 11.1429 5.04687Z"
                  />
                </svg>
                <svg
                  class="star-rating__star-icon"
                  width="12"
                  height="12"
                  fill="#ccc"
                  viewBox="0 0 12 12"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1429 5.04687C11.1429 4.84598 10.9286 4.76562 10.7679 4.73884L7.40625 4.25L5.89955 1.20312C5.83929 1.07589 5.72545 0.928571 5.57143 0.928571C5.41741 0.928571 5.30357 1.07589 5.2433 1.20312L3.73661 4.25L0.375 4.73884C0.207589 4.76562 0 4.84598 0 5.04687C0 5.16741 0.0870536 5.28125 0.167411 5.3683L2.60491 7.73884L2.02902 11.0871C2.02232 11.1339 2.01563 11.1741 2.01563 11.221C2.01563 11.3951 2.10268 11.5558 2.29688 11.5558C2.39063 11.5558 2.47768 11.5223 2.56473 11.4754L5.57143 9.89509L8.57813 11.4754C8.65848 11.5223 8.75223 11.5558 8.84598 11.5558C9.04018 11.5558 9.12054 11.3951 9.12054 11.221C9.12054 11.1741 9.12054 11.1339 9.11384 11.0871L8.53795 7.73884L10.9688 5.3683C11.0558 5.28125 11.1429 5.16741 11.1429 5.04687Z"
                  />
                </svg>
                <svg
                  class="star-rating__star-icon"
                  width="12"
                  height="12"
                  fill="#ccc"
                  viewBox="0 0 12 12"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1429 5.04687C11.1429 4.84598 10.9286 4.76562 10.7679 4.73884L7.40625 4.25L5.89955 1.20312C5.83929 1.07589 5.72545 0.928571 5.57143 0.928571C5.41741 0.928571 5.30357 1.07589 5.2433 1.20312L3.73661 4.25L0.375 4.73884C0.207589 4.76562 0 4.84598 0 5.04687C0 5.16741 0.0870536 5.28125 0.167411 5.3683L2.60491 7.73884L2.02902 11.0871C2.02232 11.1339 2.01563 11.1741 2.01563 11.221C2.01563 11.3951 2.10268 11.5558 2.29688 11.5558C2.39063 11.5558 2.47768 11.5223 2.56473 11.4754L5.57143 9.89509L8.57813 11.4754C8.65848 11.5223 8.75223 11.5558 8.84598 11.5558C9.04018 11.5558 9.12054 11.3951 9.12054 11.221C9.12054 11.1741 9.12054 11.1339 9.11384 11.0871L8.53795 7.73884L10.9688 5.3683C11.0558 5.28125 11.1429 5.16741 11.1429 5.04687Z"
                  />
                </svg>
                <svg
                  class="star-rating__star-icon"
                  width="12"
                  height="12"
                  fill="#ccc"
                  viewBox="0 0 12 12"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1429 5.04687C11.1429 4.84598 10.9286 4.76562 10.7679 4.73884L7.40625 4.25L5.89955 1.20312C5.83929 1.07589 5.72545 0.928571 5.57143 0.928571C5.41741 0.928571 5.30357 1.07589 5.2433 1.20312L3.73661 4.25L0.375 4.73884C0.207589 4.76562 0 4.84598 0 5.04687C0 5.16741 0.0870536 5.28125 0.167411 5.3683L2.60491 7.73884L2.02902 11.0871C2.02232 11.1339 2.01563 11.1741 2.01563 11.221C2.01563 11.3951 2.10268 11.5558 2.29688 11.5558C2.39063 11.5558 2.47768 11.5223 2.56473 11.4754L5.57143 9.89509L8.57813 11.4754C8.65848 11.5223 8.75223 11.5558 8.84598 11.5558C9.04018 11.5558 9.12054 11.3951 9.12054 11.221C9.12054 11.1741 9.12054 11.1339 9.11384 11.0871L8.53795 7.73884L10.9688 5.3683C11.0558 5.28125 11.1429 5.16741 11.1429 5.04687Z"
                  />
                </svg>
                <svg
                  class="star-rating__star-icon"
                  width="12"
                  height="12"
                  fill="#ccc"
                  viewBox="0 0 12 12"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1429 5.04687C11.1429 4.84598 10.9286 4.76562 10.7679 4.73884L7.40625 4.25L5.89955 1.20312C5.83929 1.07589 5.72545 0.928571 5.57143 0.928571C5.41741 0.928571 5.30357 1.07589 5.2433 1.20312L3.73661 4.25L0.375 4.73884C0.207589 4.76562 0 4.84598 0 5.04687C0 5.16741 0.0870536 5.28125 0.167411 5.3683L2.60491 7.73884L2.02902 11.0871C2.02232 11.1339 2.01563 11.1741 2.01563 11.221C2.01563 11.3951 2.10268 11.5558 2.29688 11.5558C2.39063 11.5558 2.47768 11.5223 2.56473 11.4754L5.57143 9.89509L8.57813 11.4754C8.65848 11.5223 8.75223 11.5558 8.84598 11.5558C9.04018 11.5558 9.12054 11.3951 9.12054 11.221C9.12054 11.1741 9.12054 11.1339 9.11384 11.0871L8.53795 7.73884L10.9688 5.3683C11.0558 5.28125 11.1429 5.16741 11.1429 5.04687Z"
                  />
                </svg>
              </span>
              <input type="hidden" id="form-input-rating" value="" />
            </div>
            <div class="mb-4">
              <textarea
                id="form-input-review"
                class="form-control form-control_gray"
                placeholder="Your Review"
                cols="30"
                rows="8"
              ></textarea>
            </div>
            <div class="form-label-fixed mb-4">
              <label for="form-input-name" class="form-label">Name *</label>
              <input
                id="form-input-name"
                class="form-control form-control-md form-control_gray"
              />
            </div>
            <div class="form-label-fixed mb-4">
              <label for="form-input-email" class="form-label"
                >Email address *</label
              >
              <input
                id="form-input-email"
                class="form-control form-control-md form-control_gray"
              />
            </div>
            <div class="form-check mb-4">
              <input
                class="form-check-input form-check-input_fill"
                type="checkbox"
                value=""
                id="remember_checkbox"
              />
              <label class="form-check-label" for="remember_checkbox">
                Save my name, email, and website in this browser for the next
                time I comment.
              </label>
            </div>
            <div class="form-action">
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div> {% endcomment %}
    </div>
  </section>
  <section class="products-carousel container">
    <h2 class="h3 text-uppercase mb-4 pb-xl-2 mb-xl-4">
      Related <strong>Products</strong>
    </h2>

    <div id="related_products" class="position-relative">
      <div
        class="swiper-container js-swiper-slider"
        data-settings='{
            "autoplay": false,
            "slidesPerView": 4,
            "slidesPerGroup": 4,
            "effect": "none",
            "loop": true,
            "pagination": {
              "el": "#related_products .products-pagination",
              "type": "bullets",
              "clickable": true
            },
            "navigation": {
              "nextEl": "#related_products .products-carousel__next",
              "prevEl": "#related_products .products-carousel__prev"
            },
            "breakpoints": {
              "320": {
                "slidesPerView": 2,
                "slidesPerGroup": 2,
                "spaceBetween": 14
              },
              "768": {
                "slidesPerView": 3,
                "slidesPerGroup": 3,
                "spaceBetween": 24
              },
              "992": {
                "slidesPerView": 4,
                "slidesPerGroup": 4,
                "spaceBetween": 30
              }
            }
          }'
      >
        <!-- /.swiper-wrapper -->
      </div>
      <!-- /.swiper-container js-swiper-slider -->

      <div
        class="products-carousel__prev position-absolute top-50 d-flex align-items-center justify-content-center"
      >
        <svg
          width="25"
          height="25"
          viewBox="0 0 25 25"
          xmlns="http://www.w3.org/2000/svg"
        >
          <use href="#icon_prev_md" />
        </svg>
      </div>
      <!-- /.products-carousel__prev -->
      <div
        class="products-carousel__next position-absolute top-50 d-flex align-items-center justify-content-center"
      >
        <svg
          width="25"
          height="25"
          viewBox="0 0 25 25"
          xmlns="http://www.w3.org/2000/svg"
        >
          <use href="#icon_next_md" />
        </svg>
      </div>
      <!-- /.products-carousel__next -->

      <div
        class="products-pagination mt-4 mb-5 d-flex align-items-center justify-content-center"
      ></div>
      <!-- /.products-pagination -->
    </div>
    <!-- /.position-relative -->
  </section>
  <!-- /.products-carousel container -->
</main>
<div class="mb-5 pb-xl-5"></div>



<script>
  document.addEventListener('DOMContentLoaded', function() {
    var radioButtons = document.querySelectorAll('input[name="variant_size"], input[name="variation_size"]');
    radioButtons.forEach(function(radioButton) {
      radioButton.addEventListener('click', updatePrice);
    });

    updatePrice();
  });

   // Calculate and display default price for the default selected variant type
   function calculateDefaultPrice() {
    var hasVariants = {{ has_variants|lower }};

    if (hasVariants) {
      var selectedVariantType = document.querySelector('input[name="variant_size"]:checked');
      var price = parseFloat(selectedVariantType.getAttribute('data-price'));
      var gstRate = parseFloat(selectedVariantType.getAttribute('data-gst'));
      
      var totalPrice = price + (price * (gstRate / 100));
      document.getElementById('clicked-price').textContent = totalPrice.toFixed(2);
    }
  }

  // Call the function to calculate and display default price
  calculateDefaultPrice();

  function updatePrice() {
    var hasVariants = {{ has_variants|lower }};
    var hasVariations = {{ has_variations|lower }};

    if (hasVariants && hasVariations) {
      // Proceed with logic if both variants and variations exist
      var selectedVariantType = document.querySelector('input[name="variant_size"]:checked');
      var selectedVariationType = document.querySelector('input[name="variation_size"]:checked');
      // Get the selected variant type and variation type IDs
      var selectedVariantTypeId = selectedVariantType.getAttribute('data-variant-type-id');
      var selectedVariationTypeId = selectedVariationType.getAttribute('data-variation-type-id');

      // Select the first product variant type and first product variation type by default
      if (!selectedVariantType) {
        selectedVariantType = document.querySelector('input[name="variant_size"]');
        selectedVariantType.checked = true;
      }
      if (!selectedVariationType) {
        selectedVariationType = document.querySelector('input[name="variation_size"]');
        selectedVariationType.checked = true;
      }

      // Store all the prices and product variant types that are in selected product variation type
      var variationPrices = {};

      {% for variation_type, prices in variation_prices %}
      variationPrices["{{ variation_type.id }}"] = {};
      {% for price in prices %}
      variationPrices["{{ variation_type.id }}"]["{{ price.product_variant_type.id }}"] = {
        price: {{ price.varient_type_price }},
        gstRate: "{{ price.gst_rate }}"
      };
      {% endfor %}
      {% endfor %}

      console.log(variationPrices);
      
      // Retrieve the price and GST rate from the variationPrices object
      var priceObject = variationPrices[selectedVariationTypeId][selectedVariantTypeId];
      var price = priceObject.price;
      var gstRate = priceObject.gstRate;

      // Calculate total price based on selected types
      var basePrice = price;
      var totalPrice = price * (1 + (parseFloat(gstRate) / 100));
      
      // Display the related price
      document.getElementById('clicked-price').textContent = totalPrice.toFixed(2);
    } else if (hasVariants) {
      // Proceed with logic if only variants exist
      var price = parseFloat(this.getAttribute('data-price'));
      var gstRate = parseFloat(this.getAttribute('data-gst'));

      // Select the first product variant type as default
      var selectedVariantType = document.querySelector('input[name="variant_size"]:checked');
      if (!selectedVariantType) {
        selectedVariantType = document.querySelector('input[name="variant_size"]');
        selectedVariantType.checked = true;
      }

      var basePrice = price;
      var totalPrice = price + (price * (gstRate / 100));

      document.getElementById('clicked-price').textContent = totalPrice.toFixed(2);
      totalPrice = parseFloat(document.getElementById('clicked-price').textContent);
    } else {
      // Handle other cases where neither variants nor variations exist
      document.getElementById('clicked-price').textContent = '{{default_price}}';
      totalPrice = parseFloat('{{ default_price }}');
      var basePrice = {{price_wo_gst}};
    }

    document.querySelector('.product-price-{{ products.pid }}').value = totalPrice.toFixed(2);

    document.querySelector('.product-price-wo-gst-{{ products.pid }}').value = basePrice.toFixed(2);

    // Update swatch selection styling
    updateSwatchSelection();
  }

  function updateSwatchSelection() {
    var selectedVariantType = document.querySelector('input[name="variant_size"]:checked');
    var selectedVariationType = document.querySelector('input[name="variation_size"]:checked');
    var selectedSwatches = document.querySelectorAll('.js-swatch.selected-swatch');
    
    // Remove selected class from all swatches
    selectedSwatches.forEach(function(swatch) {
      swatch.classList.remove('selected-swatch');
    });

    // Add selected class to the next sibling of selected variant type
    if (selectedVariantType) {
      selectedVariantType.nextElementSibling.classList.add('selected-swatch');
    }

    // Add selected class to the next sibling of selected variation type
    if (selectedVariationType) {
      selectedVariationType.nextElementSibling.classList.add('selected-swatch');
    }
  }
</script>


{% endblock main %}
